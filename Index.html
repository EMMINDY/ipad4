<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ iPad ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <?!= include('Styles'); ?>
</head>
<body>

    <div id="initial-page-loader" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background-color: #ffffff; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center;">
    <div class="spinner-grow text-primary" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Loading...</span>
    </div>
    <div class="mt-3 fw-bold text-secondary" style="font-size: 1.1rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö...</div>
    <div class="text-muted small mt-1">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</div>
  </div>

  <section id="view-landing" class="landing-section">
    <div class="glass-card fade-in">
      <div class="mb-3">
        <img src="https://drive.google.com/thumbnail?id=1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX&sz=w400" class="landing-logo" alt="Logo ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®" style="max-width: 130px; height: auto; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));">
      </div>
      
      <h4 class="fw-bold mb-1 text-dark">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö iPad</h4>
      <p class="mb-4 text-muted small">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</p>
      
     <button onclick="btnClick(this, enterSystem)" class="btn btn-primary btn-lg rounded-pill px-4 fw-bold shadow w-100 mb-3" style="max-width: 320px;">
        <i class="fas fa-search me-2"></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      </button>

      <button onclick="showUploadDocModal()" class="btn btn-success btn-lg rounded-pill px-4 fw-bold w-100 mb-3" style="max-width: 320px;">
        <i class="fas fa-file-upload me-2"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏¢‡∏∑‡∏°/‡∏Ñ‡∏∑‡∏ô)
      </button>

     
      <button onclick="showAdvisorLogin()" class="btn btn-outline-secondary btn-lg rounded-pill px-4 fw-bold w-100" style="max-width: 320px;">
        <i class="fas fa-user-tie me-2"></i> ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤
      </button>

      <div id="loading-spinner" class="mt-4 text-primary small hidden">
        <div class="spinner-border spinner-border-sm" role="status"></div> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
      </div>
    </div>
  </section>

  <nav id="main-nav" class="navbar custom-navbar shadow-sm hidden sticky-top">
    <div class="container-fluid px-2 px-md-3">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="javascript:void(0)" onclick="goHome(); return false;">
        <img src="https://drive.google.com/thumbnail?id=1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX&sz=w200" class="navbar-logo" alt="Logo" style="height: 40px; width: auto; margin-right: 10px;">
        <span class="d-none d-sm-inline">‡∏£‡∏∞‡∏ö‡∏ö iPad ‡∏£‡∏£.‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</span>
        <span class="d-inline d-sm-none">‡∏£‡∏∞‡∏ö‡∏ö iPad ‡∏≠‡∏£‡∏±‡∏ç‡∏Ø</span>
      </a>
      
      <div>
        <button class="btn btn-sm btn-light rounded-circle shadow-sm me-1 text-primary" onclick="goHome()">
          <i class="fas fa-home"></i>
        </button>
        <button class="btn btn-sm btn-light rounded-circle shadow-sm text-danger" onclick="goLanding()">
          <i class="fas fa-power-off"></i>
        </button>
      </div>
    </div>
  </nav>

  <div class="container mt-3 mb-5">
    
  <section id="view-dashboard" class="hidden fade-in">
      
      <div class="row g-2 mb-4 text-center">
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-primary">
            <h3 class="mb-0 fw-bold text-primary" id="totalAssetsText">0</h3>
            <small class="text-muted fw-bold">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small>
          </div>
        </div>
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-success">
            <h3 class="mb-0 fw-bold text-success" id="borrowedCountText">0</h3>
            <small class="text-muted fw-bold">‡∏¢‡∏∑‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß</small>
          </div>
        </div>
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-secondary">
            <h3 class="mb-0 fw-bold text-secondary" id="availableCountText">0</h3>
            <small class="text-muted fw-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</small>
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold text-secondary mb-0"><i class="fas fa-layer-group me-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô / ‡∏Ñ‡∏£‡∏π</h5>
      </div>
      <div class="row g-3" id="dashboard-grid"></div>
    </section>

    <section id="view-table" class="hidden fade-in">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
           <h5 class="fw-bold mb-0 text-primary" id="table-title">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h5>
           <small class="text-muted" id="table-badge">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</small>
        </div>
        <button class="btn btn-outline-secondary btn-sm rounded-pill px-3" onclick="goBackToDashboard()">
          <i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö
        </button>
      </div>

      <div class="card shadow-sm border-0 mb-3 rounded-4">
        <div class="card-body py-2 px-3">
          <div class="row g-2 align-items-center flex-wrap">
            <div class="col-auto"><span class="text-muted small fw-bold"><i class="fas fa-filter me-1"></i>‡∏Å‡∏£‡∏≠‡∏á:</span></div>
            <div class="col-md-2 col-4">
              <select id="roomFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="statusFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
                <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                <option value="‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="docFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="">‡∏ó‡∏∏‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
                <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</option>
                <option value="‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="sortByFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="name">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠</option>
                <option value="id">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™</option>
                <option value="room">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</option>
                <option value="status">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
              </select>
            </div>
            <div class="col-auto text-muted small"><span id="filteredCountText">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
          </div>
        </div>
      </div>

      <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
        <div class="card-body p-0">
          <div class="table-responsive">
            <table id="dataTable" class="table table-hover align-middle mb-0 w-100">
              <thead class="table-light text-secondary small"></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

   <section id="view-admin" class="hidden fade-in container mt-4" style="max-width: 1000px;">
      
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 bg-white p-3 rounded-4 shadow-sm gap-3">
        <div>
          <h5 class="fw-bold text-danger mb-1">
            <i class="fas fa-user-shield me-2"></i><span id="admin-title-text">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</span>
          </h5>
          <small class="text-muted" id="adminRoleDisplay">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: <span class="fw-bold text-dark">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span></small>
        </div>
        <div class="d-flex flex-wrap gap-1 justify-content-start justify-content-md-end">
          <button id="btn-audit-missing" class="btn btn-warning btn-sm rounded-pill shadow-sm text-dark fw-bold" onclick="openMissingAudit()"><i class="fas fa-exclamation-triangle me-1"></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô</button>
          <button class="btn btn-info btn-sm rounded-pill shadow-sm text-white" onclick="refreshSystemData()"><i class="fas fa-sync-alt me-1"></i> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</button>
          <button class="btn btn-success btn-sm rounded-pill shadow-sm" onclick="openExportModal()"><i class="fas fa-file-excel me-1"></i> Export</button>
          <button class="btn btn-primary btn-sm rounded-pill shadow-sm" onclick="openAdvancedReport()"><i class="fas fa-chart-line me-1"></i> ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
          <button id="btn-add-user" class="btn btn-outline-success btn-sm rounded-pill shadow-sm" onclick="openAddUserModal()"><i class="fas fa-plus"></i></button>
          <button class="btn btn-outline-danger btn-sm rounded-pill" onclick="exitAdmin()"><i class="fas fa-sign-out-alt"></i></button>
        </div>
      </div>

      <div class="row g-2 mb-4 text-center d-none d-md-flex">
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-dark"><h4 class="mb-0 fw-bold text-dark" id="stat-total">0</h4><small class="text-muted" style="font-size:10px;">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small></div></div>
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-primary"><h4 class="mb-0 fw-bold text-primary" id="stat-borrowed">0</h4><small class="text-muted" style="font-size:10px;">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</small></div></div>
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-secondary"><h4 class="mb-0 fw-bold text-secondary" id="stat-notborrow">0</h4><small class="text-muted" style="font-size:10px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</small></div></div>
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-info"><h4 class="mb-0 fw-bold text-info" id="stat-pending">0</h4><small class="text-muted" style="font-size:10px;">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</small></div></div>
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-success"><h4 class="mb-0 fw-bold text-success" id="stat-returned">0</h4><small class="text-muted" style="font-size:10px;">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</small></div></div>
         <div class="col"><div class="p-2 bg-white rounded-3 shadow-sm h-100 border-start border-3 border-danger"><h4 class="mb-0 fw-bold text-danger" id="stat-repair">0</h4><small class="text-muted" style="font-size:10px;">‡∏ã‡πà‡∏≠‡∏°/‡∏™‡∏•‡∏∞</small></div></div>
      </div>

      <div class="row mb-4 g-2 text-center">
        <div class="col-12 col-md-4">
          <button id="btnModeAll" class="btn btn-primary w-100 py-3 rounded-4 shadow-sm fw-bold" onclick="setAdminMode('all')">
            <i class="fas fa-users fs-3 d-block mb-1"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ / ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á
          </button>
        </div>
        <div class="col-6 col-md-4">
          <button id="btnModeReturn" class="btn btn-light w-100 py-3 rounded-4 shadow-sm fw-bold text-dark border" onclick="setAdminMode('return')">
            <i class="fas fa-undo fs-3 d-block mb-1 text-warning"></i> ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∑‡∏ô iPad
          </button>
        </div>
        <div class="col-6 col-md-4">
          <button id="btnModeDoc" class="btn btn-light w-100 py-3 rounded-4 shadow-sm fw-bold text-dark border" onclick="setAdminMode('doc')">
            <i class="fas fa-file-alt fs-3 d-block mb-1 text-info"></i> ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏∑‡∏°
          </button>
        </div>
      </div>

      <div id="adminFilterBox" class="card border-0 shadow-sm mb-3 bg-white rounded-4">
        <div class="card-body py-3">
          <div class="row g-2 align-items-center flex-wrap">
            <div class="col-auto text-muted small fw-bold"><i class="fas fa-filter"></i> ‡∏Å‡∏£‡∏≠‡∏á:</div>
            <div class="col-md-2 col-4">
              <select id="adminLevelFilter" class="form-select form-select-sm border-0 shadow-sm bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="adminRoomFilter" class="form-select form-select-sm border-0 shadow-sm bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="adminStatusFilter" class="form-select form-select-sm border-0 shadow-sm bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</option>
                <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="adminSortFilter" class="form-select form-select-sm border-0 shadow-sm bg-light fw-bold" onchange="filterAdminTable()">
                <option value="name">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠</option>
                <option value="id">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™</option>
                <option value="room">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</option>
                <option value="status">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
              </select>
            </div>
            <div class="col-auto small text-muted"><span id="adminFilteredCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
          </div>
        </div>
      </div>

      <div class="card shadow-sm border-0 rounded-4 mb-5">
        <div class="card-body p-3">
          <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
              <h5 id="adminTableTitle" class="fw-bold text-dark mb-0"><i class="fas fa-list text-primary me-2"></i>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h5>
              <span id="adminTableBadge" class="badge bg-primary rounded-pill px-3 py-2">...</span>
          </div>
          <div class="table-responsive">
            <table id="adminTable" class="table table-hover align-middle w-100 small">
              <thead class="table-light">
                <tr>
                  <th>‡∏£‡∏´‡∏±‡∏™</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th>
                  <th>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô</th>
                  <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  
  <div class="modal fade" id="exportModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h5 class="modal-title"><i class="fas fa-file-export me-2"></i>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Export)</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <h6 class="fw-bold text-muted mb-2">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h6>
          <div class="list-group mb-3">
            <label class="list-group-item d-flex gap-2">
              <input class="form-check-input flex-shrink-0" type="radio" name="exportScope" value="all" checked>
              <span>
                ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                <small class="d-block text-muted">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô ‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á (Database ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</small>
              </span>
            </label>
            <label class="list-group-item d-flex gap-2">
              <input class="form-check-input flex-shrink-0" type="radio" name="exportScope" value="filtered">
              <span>
                ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà
                <small class="d-block text-primary" id="exportFilterText">‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin</small>
              </span>
            </label>
          </div>

          <h6 class="fw-bold text-muted mb-2">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå</h6>
          <div class="card bg-light border-0 p-3">
            <div class="row g-2">
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_id" checked disabled><label class="form-check-label">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_name" checked disabled><label class="form-check-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_status" checked><label class="form-check-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_doc" checked><label class="form-check-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_level" checked><label class="form-check-label">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_room" checked><label class="form-check-label">‡∏´‡πâ‡∏≠‡∏á</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_serial"><label class="form-check-label">Serial Number</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_note"><label class="form-check-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label></div></div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="button" class="btn btn-success rounded-pill px-4 shadow" onclick="executeExport()">
            <i class="fas fa-download me-1"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel/CSV
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="reportModalProgress" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable"> <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-primary text-white border-0">
          <h5 class="modal-title"><i class="fas fa-chart-pie me-2"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0">
          <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle mb-0 text-center" style="font-size: 0.85rem;">
              <thead class="table-light sticky-top">
                <tr>
                  <th class="py-3">‡∏£‡∏∞‡∏î‡∏±‡∏ö/‡∏´‡πâ‡∏≠‡∏á</th>
                  <th class="py-3">‡∏ô‡∏£.‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                  <th class="py-3 bg-success bg-opacity-10 text-success border-success">
                    <i class="fas fa-tablet-alt"></i> ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                  </th>
                  <th class="py-3 bg-warning bg-opacity-10 text-dark border-warning">
                    <i class="fas fa-file-alt"></i> ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô
                  </th>
                  <th class="d-none d-md-table-cell text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</th>
                  <th class="d-none d-md-table-cell text-primary">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</th>
                  <th class="d-none d-md-table-cell text-danger">‡∏ã‡πà‡∏≠‡∏°/‡∏™‡∏•‡∏∞</th>
                </tr>
              </thead>
              <tbody id="reportTableBodyProgress">
                </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
           <small class="text-muted me-auto">* % ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° = (‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà + ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß + ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°) / ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small>
           <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="reportModalByRoom" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable"> <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-primary text-white border-0">
          <h5 class="modal-title"><i class="fas fa-chart-bar me-2"></i>‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÅ‡∏¢‡∏Å‡∏´‡πâ‡∏≠‡∏á</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table table-bordered table-sm text-center align-middle" style="font-size: 0.9rem;">
              <thead class="table-light">
                <tr>
                  <th class="text-start">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á</th>
                  <th>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                  <th class="text-secondary">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</th>
                  <th class="text-success">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</th>
                  <th class="text-primary">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</th>
                  <th class="text-danger">‡∏ã‡πà‡∏≠‡∏°/‡∏™‡∏•‡∏∞</th>
                </tr>
              </thead>
              <tbody id="reportTableBodyByRoom">
                </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
    </div>
  </div>

  <div id="admin-float-btn" class="position-fixed bottom-0 end-0 p-3" style="z-index: 1030">
    <button class="btn btn-secondary rounded-circle shadow" onclick="showAdminLogin()" style="width: 50px; height: 50px;">
      <i class="fas fa-cog"></i>
    </button>
  </div>

  <div class="modal fade" id="adminLoginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-dark text-white border-0">
          <h6 class="modal-title"><i class="fas fa-lock"></i> Admin Access</h6>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" id="adminUsernameInput" class="form-control text-center rounded-pill mb-2" placeholder="Username">
          <input type="password" id="adminPasswordInput" class="form-control text-center rounded-pill mb-2" placeholder="Password">
          <button onclick="loginAdmin()" class="btn btn-dark w-100 rounded-pill">Login</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="uploadDocModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h6 class="modal-title"><i class="fas fa-file-upload me-2"></i>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h6>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="uploadDocForm" onsubmit="handleUploadDocSubmit(this); return false;">
            <input type="hidden" name="uploadType" id="ud_uploadType">
            <div class="mb-3">
              <label class="form-label small fw-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="ud_type" id="ud_type_borrow" value="borrow" checked>
                <label class="btn btn-outline-success" for="ud_type_borrow">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</label>
                <input type="radio" class="btn-check" name="ud_type" id="ud_type_return" value="return">
                <label class="btn btn-outline-warning text-dark" for="ud_type_return">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô</label>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label small fw-bold">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤/‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ (‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏£‡∏π)</label>
              <input type="text" id="ud_searchName" class="form-control rounded-pill" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." oninput="filterUploadPersonList()">
              <select id="ud_personSelect" class="form-select mt-2" required>
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ --</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label small fw-bold">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</label>
              <input type="file" class="form-control" name="ud_file" accept="application/pdf" required>
            </div>
            <div class="mb-2">
              <label class="form-label small">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
              <textarea class="form-control" name="ud_note" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="uploadDocForm" class="btn btn-success rounded-pill px-4">
            <i class="fas fa-cloud-upload-alt me-1"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="advisorLoginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-light border-0">
          <h6 class="modal-title text-secondary"><i class="fas fa-user-tie"></i> ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤</h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" id="advUsernameInput" class="form-control text-center rounded-pill mb-2" placeholder="Username">
          <input type="password" id="advPasswordInput" class="form-control text-center rounded-pill mb-2" placeholder="Password">
          <button onclick="loginAdvisor()" class="btn btn-secondary w-100 rounded-pill">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="actionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0 shadow">
        
        <div class="modal-header bg-primary text-white border-0">
          <h5 class="modal-title fs-6"><i class="fas fa-edit me-2"></i>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        
        <div class="modal-body bg-light">
          <form id="updateForm" onsubmit="handleFormSubmit(this); return false;">
            <input type="hidden" name="userId" id="m_userId">
            <input type="hidden" name="userType" id="m_userType">
            <input type="hidden" name="userRoom" id="m_userRoom">
            <input type="hidden" name="userName" id="m_userName">
            <input type="hidden" id="m_sourceSheet">
            
            <div class="bg-white p-3 rounded-3 shadow-sm mb-3 text-center">
              <h5 id="m_displayName" class="fw-bold mb-1 text-dark">...</h5>
              <div class="mt-2">
                <label class="small text-muted mb-1">Serial Number</label>
                <input type="text" class="form-control text-center fw-bold text-primary" name="userSerial" id="m_userSerial_input" readonly style="background-color: #f8f9fa;">
              </div>
              <div class="mt-2 d-flex justify-content-center gap-2">
                 <span id="m_borrow_badge" class="badge bg-secondary">...</span>
                 <span id="m_doc_badge" class="badge bg-secondary">...</span>
              </div>
              <div id="m_doc_links" class="mt-2 small"></div>
            </div>

            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <label class="form-label small text-muted fw-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                <select class="form-select text-center fw-bold" name="statusSelect" style="pointer-events: none; background-color: #e9ecef;" tabindex="-1" required>
                  <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
                  <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‚úÖ ‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                  <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">üì• ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                  <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">üõ† ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                  <option value="‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">‚õî ‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</option>
                </select>
                <div class="text-center mt-1">
                   <small class="text-danger" style="font-size: 0.75rem;">*‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</small>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm">
              <div class="card-header bg-white fw-bold small text-muted">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏ô‡∏ö (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞ 1 PDF)</div>
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label small">1. ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° (PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</label>
                  <input type="file" class="form-control form-control-sm" name="file_agreement" accept="application/pdf">
                </div>
                <div class="mb-3">
                  <label class="form-label small">2. ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô (PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</label>
                  <input type="file" class="form-control form-control-sm" name="file_return" accept="application/pdf">
                </div>
                <div class="mt-2">
                  <label class="form-label small">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                  <textarea class="form-control" name="note" rows="2"></textarea>
                </div>
              </div>
            </div>
          </form>
        </div>
        
        <div class="modal-footer border-0 bg-white">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="updateForm" id="btnSubmit" class="btn btn-primary rounded-pill px-4 shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        
      </div>
    </div>
  </div>

  <div class="modal fade" id="previewModal" tabindex="-1" style="z-index: 1080;">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-dark text-white border-0 py-2">
          <span class="small"><i class="fas fa-file-alt me-2"></i>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
          <div class="ms-auto d-flex align-items-center gap-2">
            <div class="zoom-controls d-flex gap-2">
              <button type="button" class="btn btn-sm btn-outline-light rounded-circle" onclick="zoomPreview(0.8)" title="‡∏ã‡∏π‡∏°‡∏≠‡∏≠‡∏Å"><i class="fas fa-search-minus"></i></button>
              <button type="button" class="btn btn-sm btn-outline-light rounded-circle" onclick="zoomPreview(1.2)" title="‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤"><i class="fas fa-search-plus"></i></button>
              <button type="button" class="btn btn-sm btn-outline-light rounded-circle" onclick="rotatePreview()" title="‡∏´‡∏°‡∏∏‡∏ô 90¬∞"><i class="fas fa-sync-alt"></i></button>
              <button type="button" class="btn btn-sm btn-outline-light rounded-circle" onclick="resetPreview()" title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï"><i class="fas fa-expand-arrows-alt"></i></button>
            </div>
            <button type="button" class="btn-close btn-close-white ms-2" data-bs-dismiss="modal"></button>
          </div>
        </div>
        <div class="modal-body p-0 bg-secondary" style="height: 85vh; overflow: auto; position: relative;">
          <div id="imageContainer" class="d-flex justify-content-center" style="transition: transform 0.2s; transform-origin: top center; width: 100%;">
            <img id="previewImage" src="" class="img-fluid" style="display: none; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
          </div>
          <div id="previewIframeContainer" style="display: none; width: 100%; height: 100%;">
            <iframe id="previewIframe" src="" style="width:100%; height:100%; border:none;" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="adminEditModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content rounded-4 border-0">
      <div class="modal-header bg-danger text-white border-0">
        <h5 class="modal-title"><i class="fas fa-user-shield me-2"></i>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" style="overflow-y: auto;">
        <form id="adminForm" onsubmit="return false;">
          <input type="hidden" id="adm_id">
          <input type="hidden" id="adm_name_hidden">
          <input type="hidden" id="adm_type">
          <input type="hidden" id="adm_room">
          
          <div class="card border-0 bg-light mb-3 shadow-sm">
            <div class="card-body p-3">
              <div class="small fw-bold text-muted mb-2"><i class="fas fa-file-medical me-1"></i> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>
              
              <div class="mb-2">
                <div class="text-primary fw-bold" style="font-size: 11px;"><i class="fas fa-file-import me-1"></i>[ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° ]</div>
                <div id="adm_file_list" class="d-flex flex-wrap gap-1 mt-1">
                  </div>
              </div>

              <div class="border-top my-2 opacity-25"></div>

              <div>
                <div class="text-success fw-bold" style="font-size: 11px;"><i class="fas fa-file-export me-1"></i>[ ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ]</div>
                <div id="adm_return_file_list" class="d-flex flex-wrap gap-1 mt-1">
                  </div>
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label small fw-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="adm_name" class="form-control bg-white" readonly>
          </div>
          <div class="mb-3">
            <label class="form-label small fw-bold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç Serial Number</label>
            <input type="text" id="adm_serial" class="form-control fw-bold bg-white text-primary" readonly>
          </div>
          
          <div class="row">
             <div class="col-6 mb-3">
                <label class="form-label small text-primary fw-bold">1. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                <select id="adm_borrow_status" class="form-select form-select-sm fw-bold border-primary">
                  <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
                  <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‚úÖ ‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                  <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‚è≥ ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                  <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">üì• ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                  <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">üõ† ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                  <option value="‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">‚õî ‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</option>
                </select>
             </div>
             <div class="col-6 mb-3">
                <label class="form-label small text-warning fw-bold">2. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏∑‡∏°</label>
                <select id="adm_doc_status" class="form-select form-select-sm fw-bold border-warning">
                  <option value="">(‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)</option>
                  <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô">‚úÖ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</option>
                  <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô">‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</option>
                  <option value="‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">üü† ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                  <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á">‚ö™ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</option>
                </select>
             </div>
          </div>

          <div class="mb-3">
            <label class="form-label small fw-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (Note)</label>
            <textarea id="adm_note" class="form-control" rows="3" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer border-0 bg-light">
        <button type="button" class="btn btn-secondary rounded-pill px-3" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button type="button" class="btn btn-danger rounded-pill px-4" onclick="saveAdminData()"><i class="fas fa-save me-1"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </div>
    </div>
  </div>
</div>
  
  <div class="modal fade" id="adminAddUserModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h5 class="modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="addUserForm" onsubmit="return false;">
            <div class="mb-3">
              <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
              <select id="new_targetSheet" class="form-select" onchange="toggleNewUserFields()">
                <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3</option>
                <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.4</option>
                <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.5">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.5</option>
                <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.6">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.6</option>
                <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
              <input type="text" id="new_name" class="form-control" required>
            </div>
            <div id="new_studentFields">
              <div class="row">
                <div class="col-6 mb-3">
                  <label class="form-label">‡∏£‡∏´‡∏±‡∏™</label>
                  <input type="text" id="new_id" class="form-control">
                </div>
                <div class="col-6 mb-3">
                  <label class="form-label">‡∏´‡πâ‡∏≠‡∏á</label>
                  <input type="number" id="new_room" class="form-control">
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-success rounded-pill px-4" onclick="saveNewUser()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
      </div>
    </div>
  </div>
  

  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <?!= include('JavaScript'); ?>

  <div id="global-loading-overlay" class="hidden" style="position: fixed; inset: 0; background: rgba(255,255,255,0.7); z-index: 1050; display: flex; align-items: center; justify-content: center;">
    <div class="text-center">
      <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Loading...</span>
      </div>
      <div id="global-loading-text" class="mt-2 fw-bold text-secondary small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</div>
    </div>
  </div>

  <div class="modal fade" id="auditModalMissing" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-warning text-dark border-0">
          <h5 class="modal-title fw-bold"><i class="fas fa-exclamation-triangle me-2"></i>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0">
          <div class="alert alert-light border-0 mb-0 small text-muted p-3">
            <i class="fas fa-info-circle me-1"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï <strong>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</strong> <strong>‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏Ñ‡∏£‡∏π</strong> (‡∏≠‡∏≤‡∏à‡∏™‡∏∞‡∏Å‡∏î‡∏ú‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà)
          </div>
          <div class="table-responsive">
            <table class="table table-striped table-hover align-middle mb-0 text-center" style="font-size: 0.9rem;">
              <thead class="table-dark sticky-top">
                <tr>
                  <th>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</th>
                  <th>‡∏´‡πâ‡∏≠‡∏á</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</th>
                </tr>
              </thead>
              <tbody id="auditTableBodyMissing"></tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
          <span class="me-auto fw-bold text-danger" id="auditCountText"></span>
          <button type="button" class="btn btn-warning rounded-pill px-3" onclick="openMappingModalFromMissing()"><i class="fas fa-link me-1"></i>‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏ä‡∏∑‡πà‡∏≠</button>
          <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="auditModalMapping" tabindex="-1">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-warning text-dark">
        <h5 class="modal-title fw-bold"><i class="fas fa-link me-2"></i>‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô (Name Mapping)</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      
      <div class="modal-body p-0 bg-light">
        <div class="alert alert-warning border-0 rounded-0 mb-0 small">
          <i class="fas fa-info-circle me-1"></i> 
          ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ <strong>"‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô"</strong> (‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏´‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠)<br>
          ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ <strong>"‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"</strong> ‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ <strong>‡∏ï‡∏¥‡πä‡∏Å‡∏ñ‡∏π‡∏Å <i class="far fa-check-square"></i> ‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠</strong> ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° <strong>"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å"</strong> ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
        </div>
        <div class="table-responsive">
          <table class="table table-bordered table-hover align-middle mb-0 bg-white" style="font-size: 0.9rem;">
            <thead class="table-light sticky-top">
              <tr class="text-center text-secondary">
                <th style="width: 5%;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
                <th style="width: 30%;">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                <th style="width: 40%;">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</th>
                <th style="width: 15%;">Serial</th>
                <th style="width: 10%;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              </tr>
            </thead>
            <tbody id="auditTableBodyMapping"></tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer border-0">
        <span class="me-auto small text-muted" id="mappingCountText">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
        <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        <button type="button" class="btn btn-warning rounded-pill px-4" onclick="saveMappingSelections()"><i class="fas fa-save me-1"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</button>
      </div>
    </div>
  </div>
</div>


<div class="container mt-5 mb-3">
        <div class="text-center" style="color: #6c757d; font-size: 0.85rem;">
            <hr style="width: 30%; margin: 0 auto 10px auto; border-color: #dee2e6;">
            ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢ <strong>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏©‡∏ì‡∏∏ ‡πÅ‡∏à‡πà‡∏°‡∏õ‡∏£‡∏µ‡∏ä‡∏≤</strong><br>
            <span style="font-size: 0.75rem;">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</span>
        </div>
    </div>
    <div class="modal fade" id="advisorReturnModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0 shadow">
        <div class="modal-header bg-warning text-dark border-0">
          <h5 class="modal-title fs-6"><i class="fas fa-undo me-2"></i>‡∏ó‡∏≥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô iPad (‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body bg-light">
          <form id="advisorReturnForm" onsubmit="handleAdvisorReturnSubmit(this); return false;">
            <input type="hidden" name="userId" id="ar_userId">
            <input type="hidden" name="userType" id="ar_userType">
            <input type="hidden" name="userRoom" id="ar_userRoom">
            <input type="hidden" name="userName" id="ar_userName">
            <input type="hidden" name="userSerial" id="ar_userSerial">

            <div class="bg-white p-3 rounded-3 shadow-sm mb-3 text-center">
              <h5 id="ar_showName" class="fw-bold mb-1 text-dark">...</h5>
              <div class="small text-muted mb-2">Serial: <span id="ar_showSerial" class="text-primary fw-bold"></span></div>
            </div>

            <div class="card border-0 shadow-sm">
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label small text-danger fw-bold">* ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô</label>
                  <input type="file" class="form-control form-control-sm" name="file_return" accept="image/*,application/pdf" required>
                </div>
                <div class="mt-2">
                  <label class="form-label small">‡∏™‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ñ‡∏∂‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</label>
                  <textarea class="form-control" name="note" rows="2" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏ï‡∏Å, ‡∏™‡∏≤‡∏¢‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏´‡∏≤‡∏¢..."></textarea>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0 bg-white">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="advisorReturnForm" id="btnAdvisorReturnSubmit" class="btn btn-warning rounded-pill px-4 shadow-sm">‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
