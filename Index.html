<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ iPad ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <?!= include('Styles'); ?>

  <style>
    /* ‚îÄ‚îÄ Admin UI Improvements ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .admin-mode-btn { transition: all 0.2s ease; position: relative; }
    .admin-mode-btn .mode-count-badge {
      position: absolute; top: -6px; right: -6px;
      background: #dc3545; color: #fff; border-radius: 50px;
      font-size: 0.7rem; font-weight: 700;
      padding: 2px 6px; min-width: 20px; text-align: center;
      box-shadow: 0 2px 6px rgba(220,53,69,0.4);
    }
    .admin-search-box { max-width: 240px; }
    .serial-code {
      font-size: 0.72rem; color: #6c757d;
      background: #f4f4f4; padding: 2px 5px;
      border-radius: 4px; font-family: monospace;
      display: inline-block; max-width: 120px;
      overflow: hidden; text-overflow: ellipsis;
      white-space: nowrap; vertical-align: middle;
    }
    #adminTable tr.table-warning { background: rgba(255,193,7,0.12) !important; }
    #adminTable tr.table-info    { background: rgba(13,202,240,0.10) !important; }
    #adminTable td { padding: 8px 8px; }
    .stat-card-admin {
      border-radius: 12px; padding: 10px 14px;
      text-align: center; background: #fff;
      box-shadow: 0 1px 6px rgba(0,0,0,0.07);
    }
    .stat-card-admin h4 { margin: 0; font-size: 1.4rem; }
    .stat-card-admin small { font-size: 0.72rem; color: #6c757d; font-weight: 600; }
    .admin-toolbar { gap: 6px; }
    @media (max-width: 575px) {
      .admin-search-box { max-width: 100%; }
      .mode-btn-text { display: none; }
    }
  </style>
  <script>
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô
  const manifest = {
    "name": "‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ iPad",
    "short_name": "‡πÄ‡∏ä‡πá‡∏Ñ iPad",
    "start_url": "https://script.google.com/a/macros/aran.ac.th/s/AKfycbxYmFOUQqvoaicHNwGzhSatzwwEu4IF_uJhb4s0rcjOpSQFYEwv1HKqAn_vKoFDRuDT/exec", 
    "display": "standalone", // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
    "background_color": "#ffffff",
    "theme_color": "#1a73e8",
    "icons": [
      {
        "src": "https://drive.google.com/file/d/1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX/view?usp=drive_link",
        "sizes": "192x192",
        "type": "image/png"
      },
      {
        "src": "https://drive.google.com/file/d/1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX/view?usp=drive_link",
        "sizes": "512x512",
        "type": "image/png"
      }
    ]
  };

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Manifest ‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
  const stringManifest = JSON.stringify(manifest);
  const blob = new Blob([stringManifest], {type: 'application/json'});
  const manifestURL = URL.createObjectURL(blob);
  document.querySelector('head').insertAdjacentHTML(
    'beforeend',
    `<link rel="manifest" href="${manifestURL}">`
  );
</script>
</head>


<body>

  <div id="initial-page-loader" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:#fff;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;">
    <div class="spinner-grow text-primary" role="status" style="width:3rem;height:3rem;"></div>
    <div class="mt-3 fw-bold text-secondary" style="font-size:1.1rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö...</div>
    <div class="text-muted small mt-1">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</div>
  </div>

  <section id="view-landing" class="landing-section">
    <div class="glass-card fade-in">
      <div class="mb-3">
        <img src="https://drive.google.com/thumbnail?id=1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX&sz=w400" class="landing-logo" alt="Logo ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®" style="max-width:130px;height:auto;filter:drop-shadow(0 4px 4px rgba(0,0,0,0.1));">
      </div>
      <h4 class="fw-bold mb-1 text-dark">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö iPad</h4>
      <p class="mb-4 text-muted small">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</p>
      <button onclick="btnClick(this, enterSystem)" class="btn btn-primary btn-lg rounded-pill px-4 fw-bold shadow w-100 mb-3" style="max-width:320px;">
        <i class="fas fa-search me-2"></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      </button>
      <button onclick="showUploadDocModal()" class="btn btn-success btn-lg rounded-pill px-4 fw-bold w-100 mb-3" style="max-width:320px;">
        <i class="fas fa-file-upload me-2"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏¢‡∏∑‡∏°/‡∏Ñ‡∏∑‡∏ô)
      </button>
      <button onclick="showAdvisorLogin()" class="btn btn-outline-secondary btn-lg rounded-pill px-4 fw-bold w-100" style="max-width:320px;">
        <i class="fas fa-user-tie me-2"></i> ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤
      </button>
    </div>
  </section>

  <nav id="main-nav" class="navbar custom-navbar shadow-sm hidden sticky-top">
    <div class="container-fluid px-2 px-md-3">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="javascript:void(0)" onclick="goHome(); return false;">
        <img src="https://drive.google.com/thumbnail?id=1F9KWlzgtqzsWPfotOgNGsQ0cfPX2ahwX&sz=w200" class="navbar-logo" alt="Logo" style="height:40px;width:auto;margin-right:10px;">
        <span class="d-none d-sm-inline">‡∏£‡∏∞‡∏ö‡∏ö iPad ‡∏£‡∏£.‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</span>
        <span class="d-inline d-sm-none">‡∏£‡∏∞‡∏ö‡∏ö iPad ‡∏≠‡∏£‡∏±‡∏ç‡∏Ø</span>
      </a>
      <div>
        <button class="btn btn-sm btn-light rounded-circle shadow-sm me-1 text-primary" onclick="goHome()"><i class="fas fa-home"></i></button>
        <button class="btn btn-sm btn-light rounded-circle shadow-sm text-danger" onclick="goLanding()"><i class="fas fa-power-off"></i></button>
      </div>
    </div>
  </nav>

  <div class="container mt-3 mb-5">

    <!-- ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section id="view-dashboard" class="hidden fade-in">
      <div class="row g-2 mb-4 text-center">
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-primary">
            <h3 class="mb-0 fw-bold text-primary" id="totalAssetsText">0</h3>
            <small class="text-muted fw-bold">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small>
          </div>
        </div>
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-success">
            <h3 class="mb-0 fw-bold text-success" id="borrowedCountText">0</h3>
            <small class="text-muted fw-bold">‡∏¢‡∏∑‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß</small>
          </div>
        </div>
        <div class="col-4">
          <div class="p-3 bg-white rounded-3 shadow-sm h-100 border-start border-4 border-secondary">
            <h3 class="mb-0 fw-bold text-secondary" id="availableCountText">0</h3>
            <small class="text-muted fw-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</small>
          </div>
        </div>
      </div>
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold text-secondary mb-0"><i class="fas fa-layer-group me-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô / ‡∏Ñ‡∏£‡∏π</h5>
      </div>
      <div class="row g-3" id="dashboard-grid"></div>
    </section>

    <!-- ‚îÄ‚îÄ TABLE VIEW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section id="view-table" class="hidden fade-in">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h5 class="fw-bold mb-0 text-primary" id="table-title">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h5>
          <small class="text-muted" id="table-badge">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</small>
        </div>
        <button class="btn btn-outline-secondary btn-sm rounded-pill px-3" onclick="goBackToDashboard()">
          <i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö
        </button>
      </div>
      <div class="card shadow-sm border-0 mb-3 rounded-4">
        <div class="card-body py-2 px-3">
          <div class="row g-2 align-items-center flex-wrap">
            <div class="col-auto"><span class="text-muted small fw-bold"><i class="fas fa-filter me-1"></i>‡∏Å‡∏£‡∏≠‡∏á:</span></div>
            <div class="col-md-2 col-4">
              <select id="roomFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()"><option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option></select>
            </div>
            <div class="col-md-2 col-4">
              <select id="statusFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
                <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                <option value="‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="docFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="">‡∏ó‡∏∏‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
                <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</option>
                <option value="‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</option>
              </select>
            </div>
            <div class="col-md-2 col-4">
              <select id="sortByFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="applyTableFilters()">
                <option value="name">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠</option>
                <option value="id">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™</option>
                <option value="room">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</option>
                <option value="status">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
              </select>
            </div>
            <div class="col-auto text-muted small"><span id="filteredCountText">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
          </div>
        </div>
      </div>
      <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
        <div class="card-body p-0">
          <div class="table-responsive">
            <table id="dataTable" class="table table-hover align-middle mb-0 w-100">
              <thead class="table-light text-secondary small"></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ ADMIN VIEW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section id="view-admin" class="hidden fade-in" style="max-width:1100px; margin: 0 auto;">

      <!-- Header Bar -->
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3 bg-white p-3 rounded-4 shadow-sm gap-2">
        <div>
          <h5 class="fw-bold text-danger mb-0">
            <i class="fas fa-user-shield me-2"></i><span id="admin-title-text">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</span>
          </h5>
          <small class="text-muted" id="adminRoleDisplay">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: <span class="fw-bold text-dark">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span></small>
        </div>
        <div class="d-flex flex-wrap admin-toolbar">
          <button id="btn-audit-missing" class="btn btn-warning btn-sm rounded-pill fw-bold text-dark" onclick="openMissingAudit()">
            <i class="fas fa-exclamation-triangle me-1"></i><span class="mode-btn-text"> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô</span>
          </button>
          <button class="btn btn-info btn-sm rounded-pill text-white" onclick="refreshSystemData()">
            <i class="fas fa-sync-alt me-1"></i><span class="mode-btn-text"> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</span>
          </button>
          <button class="btn btn-success btn-sm rounded-pill" onclick="openExportModal()">
            <i class="fas fa-file-excel me-1"></i><span class="mode-btn-text"> Export</span>
          </button>
          <button class="btn btn-primary btn-sm rounded-pill" onclick="openAdvancedReport()">
            <i class="fas fa-chart-line me-1"></i><span class="mode-btn-text"> ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</span>
          </button>
          <button id="btn-add-user" class="btn btn-outline-success btn-sm rounded-pill" onclick="openAddUserModal()">
            <i class="fas fa-plus"></i>
          </button>
          <button class="btn btn-outline-danger btn-sm rounded-pill" onclick="exitAdmin()">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </div>
      </div>

      <!-- Stats Row -->
      <div class="row g-2 mb-3 text-center">
        <div class="col"><div class="stat-card-admin border-start border-3 border-dark"><h4 class="fw-bold text-dark" id="stat-total">0</h4><small>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small></div></div>
        <div class="col"><div class="stat-card-admin border-start border-3 border-primary"><h4 class="fw-bold text-primary" id="stat-borrowed">0</h4><small>‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</small></div></div>
        <div class="col"><div class="stat-card-admin border-start border-3 border-secondary"><h4 class="fw-bold text-secondary" id="stat-notborrow">0</h4><small>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</small></div></div>
        <div class="col"><div class="stat-card-admin border-start border-3 border-info"><h4 class="fw-bold text-info" id="stat-pending">0</h4><small>‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</small></div></div>
        <div class="col d-none d-md-block"><div class="stat-card-admin border-start border-3 border-success"><h4 class="fw-bold text-success" id="stat-returned">0</h4><small>‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</small></div></div>
        <div class="col d-none d-md-block"><div class="stat-card-admin border-start border-3 border-danger"><h4 class="fw-bold text-danger" id="stat-repair">0</h4><small>‡∏ã‡πà‡∏≠‡∏°/‡∏™‡∏•‡∏∞</small></div></div>
      </div>

      <!-- Mode Buttons -->
      <div class="row mb-3 g-2">
        <div class="col-4">
          <button id="btnModeAll" class="btn btn-primary w-100 py-2 rounded-4 shadow-sm fw-bold admin-mode-btn" onclick="setAdminMode('all')">
            <i class="fas fa-users d-block mb-1 fs-5"></i>
            <span class="mode-btn-text">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
            <span class="d-block d-md-none small">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
          </button>
        </div>
        <div class="col-4">
          <button id="btnModeReturn" class="btn btn-light w-100 py-2 rounded-4 shadow-sm fw-bold border admin-mode-btn text-dark" onclick="setAdminMode('return')">
            <span id="modeReturnCount" class="mode-count-badge" style="display:none;"></span>
            <i class="fas fa-undo d-block mb-1 fs-5 text-warning"></i>
            <span class="mode-btn-text">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∑‡∏ô</span>
            <span class="d-block d-md-none small">‡∏Ñ‡∏∑‡∏ô iPad</span>
          </button>
        </div>
        <div class="col-4">
          <button id="btnModeDoc" class="btn btn-light w-100 py-2 rounded-4 shadow-sm fw-bold border admin-mode-btn text-dark" onclick="setAdminMode('doc')">
            <span id="modeDocCount" class="mode-count-badge" style="display:none;"></span>
            <i class="fas fa-file-alt d-block mb-1 fs-5 text-info"></i>
            <span class="mode-btn-text">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
            <span class="d-block d-md-none small">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
          </button>
        </div>
      </div>

      <!-- Filter Bar + Search -->
      <div id="adminFilterBox" class="card border-0 shadow-sm mb-3 bg-white rounded-4">
        <div class="card-body py-2 px-3">
          <div class="row g-2 align-items-center flex-wrap">
            <div class="col-auto text-muted small fw-bold d-none d-md-block"><i class="fas fa-filter"></i></div>
            <!-- Search box -->
            <div class="col-12 col-md-auto admin-search-box">
              <div class="input-group input-group-sm">
                <span class="input-group-text bg-light border-0"><i class="fas fa-search text-muted"></i></span>
                <input type="text" id="adminSearchInput" class="form-control border-0 bg-light"
                  placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠ / ‡∏£‡∏´‡∏±‡∏™ / Serial..."
                  oninput="onAdminSearchInput(this.value)">
              </div>
            </div>
            <div class="col-6 col-md-auto">
              <select id="adminLevelFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option>
              </select>
            </div>
            <div class="col-6 col-md-auto">
              <select id="adminRoomFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
              </select>
            </div>
            <div class="col-6 col-md-auto">
              <select id="adminStatusFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="filterAdminTable()">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
              </select>
            </div>
            <div class="col-6 col-md-auto">
              <select id="adminSortFilter" class="form-select form-select-sm border-0 bg-light fw-bold" onchange="filterAdminTable()">
                <option value="name">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ä‡∏∑‡πà‡∏≠</option>
                <option value="id">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏£‡∏´‡∏±‡∏™</option>
                <option value="room">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏´‡πâ‡∏≠‡∏á</option>
                <option value="status">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
              </select>
            </div>
            <div class="col-auto small text-muted ms-auto">
              <span id="adminFilteredCount" class="fw-bold text-primary">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            </div>
          </div>
        </div>
      </div>

      <!-- Admin Table -->
      <div class="card shadow-sm border-0 rounded-4 mb-5">
        <div class="card-body p-0">
          <div class="d-flex justify-content-between align-items-center px-3 pt-3 pb-2 border-bottom">
            <h6 id="adminTableTitle" class="fw-bold text-dark mb-0"><i class="fas fa-list text-primary me-2"></i>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h6>
            <span id="adminTableBadge" class="badge bg-primary rounded-pill px-3">...</span>
          </div>
          <div class="table-responsive">
            <table id="adminTable" class="table table-hover align-middle w-100 small mb-0">
              <thead class="table-light">
                <tr>
                  <th style="width:90px;">‡∏£‡∏´‡∏±‡∏™</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• / ‡∏´‡πâ‡∏≠‡∏á</th>
                  <th style="width:120px;">Serial</th>
                  <th style="width:130px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                  <th style="width:120px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th>
                  <th style="width:140px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

  </div><!-- /container -->

  <!-- ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="text-center py-3" style="color:#6c757d;font-size:0.82rem;">
    <hr style="width:30%;margin:0 auto 8px auto;border-color:#dee2e6;">
    ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢ <strong>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏ß‡∏¥‡∏©‡∏ì‡∏∏ ‡πÅ‡∏à‡πà‡∏°‡∏õ‡∏£‡∏µ‡∏ä‡∏≤</strong><br>
    <span style="font-size:0.74rem;">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏£‡∏±‡∏ç‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</span>
  </div>

  <!-- ‚îÄ‚îÄ ADMIN FLOAT BUTTON ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="admin-float-btn" class="position-fixed bottom-0 end-0 p-3" style="z-index:1030">
    <button class="btn btn-secondary rounded-circle shadow" onclick="showAdminLogin()" style="width:50px;height:50px;" title="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô">
      <i class="fas fa-cog"></i>
    </button>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->

  <!-- ADMIN LOGIN -->
  <div class="modal fade" id="adminLoginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-dark text-white border-0">
          <h6 class="modal-title"><i class="fas fa-lock me-1"></i> Admin Access</h6>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" id="adminUsernameInput" class="form-control text-center rounded-pill mb-2" placeholder="Username">
          <input type="password" id="adminPasswordInput" class="form-control text-center rounded-pill mb-2" placeholder="Password" onkeydown="if(event.key==='Enter') loginAdmin()">
          <button onclick="loginAdmin()" class="btn btn-dark w-100 rounded-pill">Login</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ADVISOR LOGIN -->
  <div class="modal fade" id="advisorLoginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-light border-0">
          <h6 class="modal-title text-secondary"><i class="fas fa-user-tie me-1"></i> ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤</h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" id="advUsernameInput" class="form-control text-center rounded-pill mb-2" placeholder="Username">
          <input type="password" id="advPasswordInput" class="form-control text-center rounded-pill mb-2" placeholder="Password" onkeydown="if(event.key==='Enter') loginAdvisor()">
          <button onclick="loginAdvisor()" class="btn btn-secondary w-100 rounded-pill">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
      </div>
    </div>
  </div>

  <!-- UPLOAD DOC MODAL -->
  <div class="modal fade" id="uploadDocModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h6 class="modal-title"><i class="fas fa-file-upload me-2"></i>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h6>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="uploadDocForm" onsubmit="handleUploadDocSubmit(this); return false;">
            <div class="mb-3">
              <label class="form-label small fw-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
              <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="ud_type" id="ud_type_borrow" value="borrow" checked>
                <label class="btn btn-outline-success" for="ud_type_borrow">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏°</label>
                <input type="radio" class="btn-check" name="ud_type" id="ud_type_return" value="return">
                <label class="btn btn-outline-warning text-dark" for="ud_type_return">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô</label>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label small fw-bold">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤/‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠</label>
              <input type="text" id="ud_searchName" class="form-control rounded-pill mb-2" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." oninput="filterUploadPersonList()">
              <select id="ud_personSelect" class="form-select" required>
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ --</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label small fw-bold">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</label>
              <input type="file" class="form-control" name="ud_file" accept="application/pdf" required>
            </div>
            <div class="mb-2">
              <label class="form-label small">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
              <textarea class="form-control" name="ud_note" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="uploadDocForm" class="btn btn-success rounded-pill px-4">
            <i class="fas fa-cloud-upload-alt me-1"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ACTION MODAL (User upload) -->
  <div class="modal fade" id="actionModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0 shadow">
        <div class="modal-header bg-primary text-white border-0">
          <h5 class="modal-title fs-6"><i class="fas fa-edit me-2"></i>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body bg-light">
          <form id="updateForm" onsubmit="handleFormSubmit(this); return false;">
            <input type="hidden" name="userId"   id="m_userId">
            <input type="hidden" name="userType" id="m_userType">
            <input type="hidden" name="userRoom" id="m_userRoom">
            <input type="hidden" name="userName" id="m_userName">
            <input type="hidden" id="m_sourceSheet">
            <div class="bg-white p-3 rounded-3 shadow-sm mb-3 text-center">
              <h5 id="m_displayName" class="fw-bold mb-1 text-dark">...</h5>
              <div class="mt-2">
                <label class="small text-muted mb-1">Serial Number</label>
                <input type="text" class="form-control text-center fw-bold text-primary" name="userSerial" id="m_userSerial_input" readonly style="background:#f8f9fa;">
              </div>
              <div class="mt-2 d-flex justify-content-center gap-2">
                <span id="m_borrow_badge" class="badge bg-secondary">...</span>
                <span id="m_doc_badge" class="badge bg-secondary">...</span>
              </div>
            </div>
            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <h6 class="fw-bold text-muted mb-3 small text-uppercase">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà</h6>
                <div id="m_doc_links" class="mb-0"></div>
              </div>
            </div>
            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label small fw-bold text-success">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° (PDF)</label>
                  <input type="file" class="form-control form-control-sm" name="file_agreement" accept="application/pdf">
                </div>
                <div class="mb-3">
                  <label class="form-label small fw-bold text-warning">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô (PDF/‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</label>
                  <input type="file" class="form-control form-control-sm" name="file_return" accept="image/*,application/pdf">
                </div>
                <div>
                  <label class="form-label small">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                  <textarea class="form-control form-control-sm" name="note" rows="2" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="updateForm" class="btn btn-primary rounded-pill px-4">
            <i class="fas fa-save me-1"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ADMIN EDIT MODAL -->
  <div class="modal fade" id="adminEditModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0 shadow">
        <div class="modal-header bg-danger text-white border-0">
          <h5 class="modal-title fs-6"><i class="fas fa-cog me-2"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin)</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="adm_id">
          <input type="hidden" id="adm_name_hidden">
          <input type="hidden" id="adm_type">

         <div class="bg-light rounded-3 p-3 mb-3">
            <div class="row g-2">
              <div class="col-6">
                <label class="form-label small fw-bold text-muted">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                <input type="text" id="adm_name" class="form-control form-control-sm" readonly style="background:#fff;">
              </div>
              <div class="col-3">
                <label class="form-label small fw-bold text-muted">‡∏´‡πâ‡∏≠‡∏á</label>
                <input type="text" id="adm_room" class="form-control form-control-sm" readonly style="background:#fff;">
              </div>
              <div class="col-3">
                <label class="form-label small fw-bold text-muted">Serial</label>
                <select id="adm_serial" class="form-select form-select-sm border-primary" style="background:#fff;"></select>
              </div>
            </div>
          </div>

          <!-- Status Controls -->
          <div class="card border-0 shadow-sm mb-3">
            <div class="card-body">
              <h6 class="fw-bold text-muted mb-3 small"><i class="fas fa-edit me-1"></i>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h6>
              <div class="row g-2">
                <div class="col-6">
                  <label class="form-label small fw-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                  <select id="adm_borrow_status" class="form-select form-select-sm">
                    <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</option>
                    <option value="‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà</option>
                    <option value="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                    <option value="‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß">‚úÖ ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</option>
                    <option value="‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°">üîß ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</option>
                    <option value="‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">‡∏™‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</option>
                  </select>
                </div>
                <div class="col-6">
                  <label class="form-label small fw-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                  <select id="adm_doc_status" class="form-select form-select-sm">
                    <option value="">-- ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô --</option>
                    <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</option>
                    <option value="‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                    <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô">‚úÖ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</option>
                    <option value="‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô">‚ùå ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Files -->
          <div class="card border-0 shadow-sm mb-3">
            <div class="card-body">
              <h6 class="fw-bold text-muted mb-2 small"><i class="fas fa-paperclip me-1"></i>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h6>
              <div class="mb-2" id="adm_file_list"></div>
              <div id="adm_return_file_list"></div>
            </div>
          </div>

          <!-- Note -->
          <div>
            <label class="form-label small fw-bold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
            <textarea id="adm_note" class="form-control form-control-sm" rows="2" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."></textarea>
          </div>
        </div>
        <div class="modal-footer border-0 d-flex">
          <button type="button" class="btn btn-outline-danger btn-sm rounded-pill me-auto"
            onclick="var id=document.getElementById('adm_id').value; var name=document.getElementById('adm_name').value; var p=systemData.find(function(x){return String(x.id)===String(id);}); confirmDeleteUser(id, p?p.source_sheet:'', name);">
            <i class="fas fa-trash me-1"></i>‡∏•‡∏ö
          </button>
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="button" class="btn btn-danger rounded-pill px-4" onclick="saveAdminData()">
            <i class="fas fa-save me-1"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ADVISOR RETURN MODAL -->
  <div class="modal fade" id="advisorReturnModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0 shadow">
        <div class="modal-header bg-warning text-dark border-0">
          <h5 class="modal-title fs-6"><i class="fas fa-undo me-2"></i>‡∏ó‡∏≥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô iPad (‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body bg-light">
          <form id="advisorReturnForm" onsubmit="handleAdvisorReturnSubmit(this); return false;">
            <input type="hidden" name="userId"    id="ar_userId">
            <input type="hidden" name="userType"  id="ar_userType">
            <input type="hidden" name="userRoom"  id="ar_userRoom">
            <input type="hidden" name="userName"  id="ar_userName">
            <input type="hidden" name="userSerial" id="ar_userSerial">
            <div class="bg-white p-3 rounded-3 shadow-sm mb-3 text-center">
              <h5 id="ar_showName" class="fw-bold mb-1 text-dark">...</h5>
              <div class="small text-muted mb-2">Serial: <span id="ar_showSerial" class="text-primary fw-bold"></span></div>
            </div>
            <div class="card border-0 shadow-sm">
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label small text-danger fw-bold">* ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô</label>
                  <input type="file" class="form-control form-control-sm" name="file_return" accept="image/*,application/pdf" required>
                </div>
                <div>
                  <label class="form-label small">‡∏™‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏)</label>
                  <textarea class="form-control" name="note" rows="2" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏ï‡∏Å, ‡∏™‡∏≤‡∏¢‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏´‡∏≤‡∏¢..."></textarea>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0 bg-white">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" form="advisorReturnForm" class="btn btn-warning rounded-pill px-4 shadow-sm fw-bold text-dark">
            <i class="fas fa-paper-plane me-1"></i>‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- EXPORT MODAL -->
  <div class="modal fade" id="exportModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h5 class="modal-title"><i class="fas fa-file-export me-2"></i>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Export)</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <h6 class="fw-bold text-muted mb-2">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h6>
          <div class="list-group mb-3">
            <label class="list-group-item d-flex gap-2">
              <input class="form-check-input flex-shrink-0" type="radio" name="exportScope" value="all" checked>
              <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <small class="d-block text-muted">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô ‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</small></span>
            </label>
            <label class="list-group-item d-flex gap-2">
              <input class="form-check-input flex-shrink-0" type="radio" name="exportScope" value="filtered">
              <span>‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà <small class="d-block text-primary" id="exportFilterText">‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin</small></span>
            </label>
          </div>
          <h6 class="fw-bold text-muted mb-2">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå</h6>
          <div class="card bg-light border-0 p-3">
            <div class="row g-2">
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_id" checked disabled><label class="form-check-label small">‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_name" checked disabled><label class="form-check-label small">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_status" checked><label class="form-check-label small">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_doc" checked><label class="form-check-label small">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_level" checked><label class="form-check-label small">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_room" checked><label class="form-check-label small">‡∏´‡πâ‡∏≠‡∏á</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_serial"><label class="form-check-label small">Serial Number</label></div></div>
              <div class="col-6"><div class="form-check"><input class="form-check-input" type="checkbox" id="col_note"><label class="form-check-label small">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label></div></div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="button" class="btn btn-success rounded-pill px-4" onclick="executeExport()">
            <i class="fas fa-download me-1"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CSV
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- REPORT MODAL -->
  <div class="modal fade" id="reportModalProgress" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-primary text-white border-0">
          <h5 class="modal-title"><i class="fas fa-chart-pie me-2"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0">
          <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle mb-0 text-center" style="font-size:0.85rem;">
              <thead class="table-light sticky-top">
                <tr>
                  <th class="py-3 text-start">‡∏£‡∏∞‡∏î‡∏±‡∏ö/‡∏´‡πâ‡∏≠‡∏á</th>
                  <th class="py-3">‡∏ô‡∏£.‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                  <th class="py-3 bg-success bg-opacity-10 text-success"><i class="fas fa-tablet-alt"></i> ‡∏¢‡∏∑‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</th>
                  <th class="py-3 bg-warning bg-opacity-10"><i class="fas fa-file-alt"></i> ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</th>
                  <th class="d-none d-md-table-cell text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏°</th>
                  <th class="d-none d-md-table-cell text-primary">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß</th>
                  <th class="d-none d-md-table-cell text-danger">‡∏ã‡πà‡∏≠‡∏°/‡∏™‡∏•‡∏∞</th>
                </tr>
              </thead>
              <tbody id="reportTableBodyProgress"></tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
          <small class="text-muted me-auto">* % ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏° = (‡∏¢‡∏∑‡∏°‡∏≠‡∏¢‡∏π‡πà + ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß + ‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°) / ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small>
          <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
    </div>
  </div>

  <!-- AUDIT MODAL MISSING -->
  <div class="modal fade" id="auditModalMissing" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-warning text-dark border-0">
          <h5 class="modal-title fw-bold"><i class="fas fa-exclamation-triangle me-2"></i>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏´‡∏≤‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0">
          <div class="alert alert-light border-0 mb-0 small text-muted p-3">
            <i class="fas fa-info-circle me-1"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ä‡∏µ‡∏ï <strong>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</strong> ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡∏≠‡∏≤‡∏à‡∏™‡∏∞‡∏Å‡∏î‡∏ú‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà)
          </div>
          <div class="table-responsive">
            <table class="table table-striped table-hover align-middle mb-0 text-center" style="font-size:0.9rem;">
              <thead class="table-dark sticky-top">
                <tr><th>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</th><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th><th>Serial</th></tr>
              </thead>
              <tbody id="auditTableBodyMissing"></tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
          <span class="me-auto fw-bold text-danger" id="auditCountText"></span>
          <button type="button" class="btn btn-warning rounded-pill px-3" onclick="openMappingModalFromMissing()"><i class="fas fa-link me-1"></i>‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏ä‡∏∑‡πà‡∏≠</button>
          <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
    </div>
  </div>

  <!-- AUDIT MODAL MAPPING -->
  <div class="modal fade" id="auditModalMapping" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header bg-warning text-dark">
          <h5 class="modal-title fw-bold"><i class="fas fa-link me-2"></i>‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏Å‡∏´‡∏•‡πà‡∏ô</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0 bg-light">
          <div class="alert alert-warning border-0 rounded-0 mb-0 small">
            <i class="fas fa-info-circle me-1"></i>
            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å dropdown ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î <strong>"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà"</strong>
          </div>
          <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle mb-0 bg-white" style="font-size:0.9rem;">
              <thead class="table-light sticky-top">
                <tr class="text-center text-secondary">
                  <th style="width:5%;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
                  <th style="width:30%;">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</th>
                  <th style="width:40%;">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</th>
                  <th style="width:15%;">Serial</th>
                  <th style="width:10%;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
              </thead>
              <tbody id="auditTableBodyMapping"></tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-0">
          <span class="me-auto small text-muted" id="mappingCountText">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
          <button type="button" class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
          <button type="button" class="btn btn-warning rounded-pill px-4" onclick="saveMappingSelections()"><i class="fas fa-save me-1"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ADD USER MODAL -->
  <div class="modal fade" id="adminAddUserModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header bg-success text-white border-0">
          <h6 class="modal-title"><i class="fas fa-user-plus me-2"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h6>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label small fw-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏µ‡∏ï</label>
            <select id="new_targetSheet" class="form-select" onchange="toggleNewUserFields()">
              <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3</option>
              <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.4">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.4</option>
              <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.5">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.5</option>
              <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.6">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.6</option>
              <option value="‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π">‡∏Ñ‡∏£‡∏π</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label small fw-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="new_name" class="form-control" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
          </div>
          <div id="new_studentFields">
            <div class="row g-2">
              <div class="col-6 mb-3">
                <label class="form-label small fw-bold">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                <input type="text" id="new_id" class="form-control">
              </div>
              <div class="col-6 mb-3">
                <label class="form-label small fw-bold">‡∏´‡πâ‡∏≠‡∏á</label>
                <input type="number" id="new_room" class="form-control">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-light rounded-pill" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="button" class="btn btn-success rounded-pill px-4" onclick="saveNewUser()">
            <i class="fas fa-plus me-1"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- PREVIEW MODAL -->
  <div class="modal fade" id="previewModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content rounded-4 border-0">
        <div class="modal-header border-0 pb-1">
          <h6 class="modal-title fw-bold"><i class="fas fa-eye me-2"></i>‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h6>
          <div class="zoom-controls d-flex gap-1 me-2">
            <button class="btn btn-sm btn-light border" onclick="zoomPreview(1.2)" title="‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤"><i class="fas fa-search-plus"></i></button>
            <button class="btn btn-sm btn-light border" onclick="zoomPreview(0.8)" title="‡∏ã‡∏π‡∏°‡∏≠‡∏≠‡∏Å"><i class="fas fa-search-minus"></i></button>
            <button class="btn btn-sm btn-light border" onclick="rotatePreview()" title="‡∏´‡∏°‡∏∏‡∏ô"><i class="fas fa-redo"></i></button>
            <button class="btn btn-sm btn-light border" onclick="resetPreview()" title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï"><i class="fas fa-compress-arrows-alt"></i></button>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-0" style="min-height:70vh;">
          <div id="previewIframeContainer" style="display:none;height:75vh;">
            <iframe id="previewIframe" src="" style="width:100%;height:100%;border:none;" allowfullscreen></iframe>
          </div>
          <div id="imageContainer">
            <img id="previewImage" src="" style="display:none;max-width:100%;height:auto;" alt="preview">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ SCRIPTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
  <?!= include('JavaScript'); ?>

  <!-- GLOBAL LOADING OVERLAY -->
  <div id="global-loading-overlay" class="hidden" style="position:fixed;inset:0;background:rgba(255,255,255,0.75);z-index:1050;display:flex;align-items:center;justify-content:center;">
    <div class="text-center">
      <div class="spinner-border text-primary" role="status" style="width:3rem;height:3rem;"></div>
      <div id="global-loading-text" class="mt-2 fw-bold text-secondary small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</div>
    </div>
  </div>

</body>
</html>
